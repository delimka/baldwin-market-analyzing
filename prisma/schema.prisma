datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

generator client {
  provider = "prisma-client-js"
}

enum MarketType {
  stock
  crypto
}

model Position {
  id        String    @id @default(cuid())
  type      MarketType
  symbol    String
  qty       Decimal
  avgPrice  Decimal
  currency  String    @default("USD")
  openedAt  DateTime  @default(now())
  updatedAt DateTime  @updatedAt

  trades    Trade[]
  @@index([type, symbol])
}

model Trade {
  id         String    @id @default(cuid())
  positionId String
  position   Position  @relation(fields: [positionId], references: [id], onDelete: Cascade)

  side       String    // "BUY" | "SELL"
  qty        Decimal
  price      Decimal
  fee        Decimal? 
  note       String?
  executedAt DateTime  @default(now())

  @@index([executedAt])
}
